---
title: 部署VictoriaMetrics
date: 2025-08-13 11:28:01
cover: 
feature: false
tags:
  - 运维
categories:
  - 运维
---


## 下载软件包

访问 GitHub 下载软件包,[点这里跳转](https://github.com/VictoriaMetrics/VictoriaMetrics/releases)

随便选个版本,你可以直接选最新的, 顺便注意一下, 名字里面最好别带 `enterprise` 字样, 因为这玩意是企业版收费的, 我们用免费的就行.

比如我这里选择版本`v1.122.0`, 下载`victoria-metrics-linux-amd64-v1.122.0.tar.gz`, 这个可以根据各自的需求来.


```bash
wget https://release-assets.githubusercontent.com/github-production-release-asset/xxxxx -O victoria-metrics-linux-amd64-v1.122.0.tar.gz
tar -zxvf victoria-metrics-linux-amd64-v1.122.0.tar.gz 
```

## 配置VictoriaMetrics

下载并且解压后,可以看见一个`victoria-metrics-prod`二进制(我使用的是单例,如果是集群版本的话应该是有更多二进制的)

并且我这里是使用`supervisorctl`做服务单元的,如果你使用的是systemd, 那么应该将`victoria-metrics.conf`写到正确的路径去

`/apps/data/workspace/VictoriaMetrics/victoria-metrics-prod`是我二进制所在的绝对路径,你应该根据实际情况来修改.

```bash
#!/usr/bin/env bash

mkdir -p /data/vmdata
mkdir -p /etc/supervisor.d/

cat >/etc/supervisor.d/victoria-metrics.conf <<EOF
[program:victoria-metrics]
directory=/apps/data/workspace/VictoriaMetrics/
command=/apps/data/workspace/VictoriaMetrics/victoria-metrics-prod \
    -storageDataPath=/data/vmdata \
    -httpListenAddr=:8888 \
    -retentionPeriod=1y \
    -httpAuth.username=admin \
    -httpAuth.password=123456
autostart=true
autorestart=true
startsecs=5
stdout_logfile=/apps/data/workspace/VictoriaMetrics/logs/stdout.log
stderr_logfile=/apps/data/workspace/VictoriaMetrics/logs/stderr.log
user=root
EOF

# 启动服务
supervisorctl reread
supervisorctl update
supervisorctl start victoria-metrics
supervisorctl status victoria-metrics
```

**参数介绍**

- storageDataPath: 数据存储路径
- httpListenAddr: 监听地址+端口
- retentionPeriod: 数据保留时间(1y 表示一年)
- httpAuth.username: 用户名 (可选)
- httpAuth.password: 密码 (可选)


## 检查端口监听

如果服务正常在监听端口,那就没问题了

```bash
netstat -ntulp | grep 8888
```
