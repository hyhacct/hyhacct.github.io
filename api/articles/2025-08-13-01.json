{"title":"部署VictoriaMetrics","uid":"880e43f95a76f1f67cdba4fa93ef30c6","slug":"2025-08-13-01","date":"2025-08-13T11:28:01.000Z","updated":"2025-09-03T09:27:53.510Z","comments":true,"path":"api/articles/2025-08-13-01.json","keywords":null,"cover":null,"content":"<h2 id=\"下载软件包\"><a href=\"#下载软件包\" class=\"headerlink\" title=\"下载软件包\"></a>下载软件包</h2><p>访问 GitHub 下载软件包,<a href=\"https://github.com/VictoriaMetrics/VictoriaMetrics/releases\">点这里跳转</a></p>\n<p>随便选个版本,你可以直接选最新的, 顺便注意一下, 名字里面最好别带 <code>enterprise</code> 字样, 因为这玩意是企业版收费的, 我们用免费的就行.</p>\n<p>比如我这里选择版本<code>v1.122.0</code>, 下载<code>victoria-metrics-linux-amd64-v1.122.0.tar.gz</code>, 这个可以根据各自的需求来.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://release-assets.githubusercontent.com/github-production-release-asset/xxxxx -O victoria-metrics-linux-amd64-v1.122.0.tar.gz</span><br><span class=\"line\">tar -zxvf victoria-metrics-linux-amd64-v1.122.0.tar.gz </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置VictoriaMetrics\"><a href=\"#配置VictoriaMetrics\" class=\"headerlink\" title=\"配置VictoriaMetrics\"></a>配置VictoriaMetrics</h2><p>下载并且解压后,可以看见一个<code>victoria-metrics-prod</code>二进制(我使用的是单例,如果是集群版本的话应该是有更多二进制的)</p>\n<p>并且我这里是使用<code>supervisorctl</code>做服务单元的,如果你使用的是systemd, 那么应该将<code>victoria-metrics.conf</code>写到正确的路径去</p>\n<p><code>/apps/data/workspace/VictoriaMetrics/victoria-metrics-prod</code>是我二进制所在的绝对路径,你应该根据实际情况来修改.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/usr/bin/env bash</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /data/vmdata</span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /etc/supervisor.d/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cat</span> &gt;/etc/supervisor.d/victoria-metrics.conf &lt;&lt;<span class=\"string\">EOF</span></span><br><span class=\"line\"><span class=\"string\">[program:victoria-metrics]</span></span><br><span class=\"line\"><span class=\"string\">directory=/apps/data/workspace/VictoriaMetrics/</span></span><br><span class=\"line\"><span class=\"string\">command=/apps/data/workspace/VictoriaMetrics/victoria-metrics-prod \\</span></span><br><span class=\"line\"><span class=\"string\">    -storageDataPath=/data/vmdata \\</span></span><br><span class=\"line\"><span class=\"string\">    -httpListenAddr=:8888 \\</span></span><br><span class=\"line\"><span class=\"string\">    -retentionPeriod=1y \\</span></span><br><span class=\"line\"><span class=\"string\">    -httpAuth.username=admin \\</span></span><br><span class=\"line\"><span class=\"string\">    -httpAuth.password=123456</span></span><br><span class=\"line\"><span class=\"string\">autostart=true</span></span><br><span class=\"line\"><span class=\"string\">autorestart=true</span></span><br><span class=\"line\"><span class=\"string\">startsecs=5</span></span><br><span class=\"line\"><span class=\"string\">stdout_logfile=/apps/data/workspace/VictoriaMetrics/logs/stdout.log</span></span><br><span class=\"line\"><span class=\"string\">stderr_logfile=/apps/data/workspace/VictoriaMetrics/logs/stderr.log</span></span><br><span class=\"line\"><span class=\"string\">user=root</span></span><br><span class=\"line\"><span class=\"string\">EOF</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 启动服务</span></span><br><span class=\"line\">supervisorctl reread</span><br><span class=\"line\">supervisorctl update</span><br><span class=\"line\">supervisorctl start victoria-metrics</span><br><span class=\"line\">supervisorctl status victoria-metrics</span><br></pre></td></tr></table></figure>\n\n<p><strong>参数介绍</strong></p>\n<ul>\n<li>storageDataPath: 数据存储路径</li>\n<li>httpListenAddr: 监听地址+端口</li>\n<li>retentionPeriod: 数据保留时间(1y 表示一年)</li>\n<li>httpAuth.username: 用户名 (可选)</li>\n<li>httpAuth.password: 密码 (可选)</li>\n</ul>\n<h2 id=\"检查端口监听\"><a href=\"#检查端口监听\" class=\"headerlink\" title=\"检查端口监听\"></a>检查端口监听</h2><p>如果服务正常在监听端口,那就没问题了</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat -ntulp | grep 8888</span><br></pre></td></tr></table></figure>\n","feature":false,"text":"下载软件包访问 GitHub 下载软件包,点这里跳转 随便选个版本,你可以直接选最新的, 顺便注意一下, 名字里面最好别带 enterprise 字样, 因为这...","permalink":"/post/2025-08-13-01","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"运维","slug":"运维","count":10,"path":"api/categories/运维.json"}],"tags":[{"name":"运维","slug":"运维","count":3,"path":"api/tags/运维.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BD%E8%BD%AF%E4%BB%B6%E5%8C%85\"><span class=\"toc-text\">下载软件包</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AEVictoriaMetrics\"><span class=\"toc-text\">配置VictoriaMetrics</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%A3%80%E6%9F%A5%E7%AB%AF%E5%8F%A3%E7%9B%91%E5%90%AC\"><span class=\"toc-text\">检查端口监听</span></a></li></ol>","author":{"name":"Reverse","slug":"blog-author","avatar":"/images/avatar.jpg","link":"/","description":"每一次的突破，都是自我超越的见证。","socials":{"github":"https://github.com/hyhacct","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"部署夜莺监控","uid":"9fb5a13df7aebee902991d52a2edd9f7","slug":"2025-08-13-02","date":"2025-08-13T12:35:53.000Z","updated":"2025-09-03T09:27:53.510Z","comments":true,"path":"api/articles/2025-08-13-02.json","keywords":null,"cover":null,"text":"下载软件包GitHub 下载软件包,点这里跳转 我这里使用v8.2.2版本,下载n9e-v8.2.2-linux-amd64.tar.gz 1wget http...","permalink":"/post/2025-08-13-02","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"运维","slug":"运维","count":10,"path":"api/categories/运维.json"}],"tags":[{"name":"运维","slug":"运维","count":3,"path":"api/tags/运维.json"}],"author":{"name":"Reverse","slug":"blog-author","avatar":"/images/avatar.jpg","link":"/","description":"每一次的突破，都是自我超越的见证。","socials":{"github":"https://github.com/hyhacct","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":false},"next_post":{"title":"占用CPU的Antimalware Service Executable进程","uid":"399a23380cfb251e18014f6946821ddd","slug":"2025-08-10-01","date":"2025-08-10T19:46:56.000Z","updated":"2025-09-03T09:27:53.510Z","comments":true,"path":"api/articles/2025-08-10-01.json","keywords":null,"cover":[],"text":"问题描述最近重装了一下电脑,发现有时候 CPU 占用非常高,任务管理器里面一看,有个叫Antimalware Service Executable的进程占有率直...","permalink":"/post/2025-08-10-01","photos":[],"count_time":{"symbolsCount":343,"symbolsTime":"1 mins."},"categories":[{"name":"Windows","slug":"Windows","count":1,"path":"api/categories/Windows.json"}],"tags":[{"name":"Windows","slug":"Windows","count":1,"path":"api/tags/Windows.json"}],"author":{"name":"Reverse","slug":"blog-author","avatar":"/images/avatar.jpg","link":"/","description":"每一次的突破，都是自我超越的见证。","socials":{"github":"https://github.com/hyhacct","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":false}}