{"title":"Docker守护进程连接错误","uid":"11dfc50955afa32461ac370ac3e78a2c","slug":"2025-07-19-02","date":"2025-07-19T14:34:01.000Z","updated":"2025-08-16T02:33:51.939Z","comments":true,"path":"api/articles/2025-07-19-02.json","keywords":null,"cover":null,"content":"<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>在使用 docker 时，发现 docker 守护进程出现连接错误，如下：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# docker restart -t1 tools-nginx-1</span><br><span class=\"line\">Error response from daemon: Cannot restart container tools-nginx-1: connection error: desc = <span class=\"string\">&quot;transport: Error while dialing: dial unix /run/containerd/containerd.sock: connect: connection refused&quot;</span>: unavailable</span><br><span class=\"line\">[root@localhost ~]#</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"尝试解决\"><a href=\"#尝试解决\" class=\"headerlink\" title=\"尝试解决\"></a>尝试解决</h2><p>先检查了一下<code>containerd</code>的状态，看了下是异常了，目前退出代码为<code>2</code>(<strong>status&#x3D;2</strong>)</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# systemctl status containerd</span><br><span class=\"line\">● containerd.service - containerd container runtime</span><br><span class=\"line\">   Loaded: loaded (/usr/local/lib/systemd/system/containerd.service; disabled; vendor preset: disabled)</span><br><span class=\"line\">   Active: activating (auto-restart) (Result: exit-code) since Sun 2024-12-22 18:36:42 CST; 3s ago</span><br><span class=\"line\">     Docs: https://containerd.io</span><br><span class=\"line\">  Process: 48729 ExecStart=/usr/local/bin/containerd (code=exited, status=2)</span><br><span class=\"line\">  Process: 48727 ExecStartPre=/sbin/modprobe overlay (code=exited, status=0/SUCCESS)</span><br><span class=\"line\"> Main PID: 48729 (code=exited, status=2)</span><br><span class=\"line\"></span><br><span class=\"line\">Dec 22 18:36:42 localhost systemd[1]: containerd.service: main process exited, code=exited, status=2/INVALIDARGUMENT</span><br><span class=\"line\">Dec 22 18:36:42 localhost systemd[1]: Unit containerd.service entered failed state.</span><br><span class=\"line\">Dec 22 18:36:42 localhost systemd[1]: containerd.service failed.</span><br><span class=\"line\">[root@localhost ~]#</span><br></pre></td></tr></table></figure>\n\n<p>尝试重启一下<code>containerd</code>服务：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# systemctl restart containerd</span><br><span class=\"line\">[root@localhost ~]# systemctl status containerd</span><br><span class=\"line\">● containerd.service - containerd container runtime</span><br><span class=\"line\">   Loaded: loaded (/usr/local/lib/systemd/system/containerd.service; disabled; vendor preset: disabled)</span><br><span class=\"line\">   Active: activating (auto-restart) (Result: exit-code) since Sun 2024-12-22 18:37:32 CST; 1s ago</span><br><span class=\"line\">     Docs: https://containerd.io</span><br><span class=\"line\">  Process: 49241 ExecStart=/usr/local/bin/containerd (code=exited, status=2)</span><br><span class=\"line\">  Process: 49239 ExecStartPre=/sbin/modprobe overlay (code=exited, status=0/SUCCESS)</span><br><span class=\"line\"> Main PID: 49241 (code=exited, status=2)</span><br><span class=\"line\"></span><br><span class=\"line\">Dec 22 18:37:32 localhost containerd[49241]: github.com/containerd/containerd/gc/scheduler.(*gcScheduler).run(0xc00078ec00, 0x5636f1cb28b0, 0xc000040038)</span><br><span class=\"line\">Dec 22 18:37:32 localhost containerd[49241]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/g...0 +0x4bf</span><br><span class=\"line\">Dec 22 18:37:32 localhost containerd[49241]: created by github.com/containerd/containerd/gc/scheduler.init.0.func1</span><br><span class=\"line\">Dec 22 18:37:32 localhost containerd[49241]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/g...2 +0x445</span><br><span class=\"line\">Dec 22 18:37:32 localhost systemd[1]: Unit containerd.service entered failed state.</span><br><span class=\"line\">Dec 22 18:37:32 localhost systemd[1]: containerd.service failed.</span><br><span class=\"line\">Hint: Some lines were ellipsized, use -l to show <span class=\"keyword\">in</span> full.</span><br><span class=\"line\">[root@localhost ~]#</span><br></pre></td></tr></table></figure>\n\n<p>但是并没有卵用，还是没起来，尝试下其他办法，查看错误日志，如下：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">journalctl -u containerd -n 50 --no-pager</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight txt\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-- Logs begin at Sun 2024-12-22 17:12:15 CST, end at Sun 2024-12-22 18:40:57 CST. --</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.241193631+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.runtime.v1.linux\\&quot;...&quot; type=io.containerd.runtime.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.241259832+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.runtime.v2.task\\&quot;...&quot; type=io.containerd.runtime.v2</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.241334756+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.monitor.v1.cgroups\\&quot;...&quot; type=io.containerd.monitor.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242006839+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.service.v1.tasks-service\\&quot;...&quot; type=io.containerd.service.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242068886+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.internal.v1.restart\\&quot;...&quot; type=io.containerd.internal.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242163233+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.containers\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242191794+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.content\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242212102+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.diff\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242231735+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.events\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242253326+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.healthcheck\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242273932+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.images\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242296738+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.leases\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242321583+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.namespaces\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242340220+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.internal.v1.opt\\&quot;...&quot; type=io.containerd.internal.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242390209+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.snapshots\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242431370+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.tasks\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242456434+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.version\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242489898+08:00&quot; level=info msg=&quot;loading plugin \\&quot;io.containerd.grpc.v1.introspection\\&quot;...&quot; type=io.containerd.grpc.v1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242827737+08:00&quot; level=info msg=serving... address=/run/containerd/containerd.sock.ttrpc</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.242932534+08:00&quot; level=info msg=serving... address=/run/containerd/containerd.sock</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: time=&quot;2024-12-22T18:40:57.243027297+08:00&quot; level=info msg=&quot;containerd successfully booted in 0.043640s&quot;</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: panic: invalid page type: 2: 10 // [!code highlight]</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: goroutine 114 [running]:</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: go.etcd.io/bbolt.(*Cursor).search(0xc00026b080, 0x561b6f733918, 0x6, 0x6, 0x2)</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/vendor/go.etcd.io/bbolt/cursor.go:250 +0x345</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: go.etcd.io/bbolt.(*Cursor).seek(0xc00026b080, 0x561b6f733918, 0x6, 0x6, 0xc00033c200, 0x4, 0x4, 0x7fd8a035d034, 0x10, 0x10, ...)</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/vendor/go.etcd.io/bbolt/cursor.go:159 +0x7f</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: go.etcd.io/bbolt.(*Bucket).Bucket(0xc00033c200, 0x561b6f733918, 0x6, 0x6, 0xc00033c200)</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/vendor/go.etcd.io/bbolt/bucket.go:105 +0xda</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: github.com/containerd/containerd/metadata.scanRoots.func2(0x7fd8a035d030, 0x4, 0x4, 0x0, 0x0, 0x0, 0x0, 0x561b6d685131)</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/metadata/gc.go:101 +0xf1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: go.etcd.io/bbolt.(*Bucket).ForEach(0xc00033c180, 0xc00026b6e8, 0x6, 0x6)</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/vendor/go.etcd.io/bbolt/bucket.go:390 +0x104</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: github.com/containerd/containerd/metadata.scanRoots(0x561b6edc8878, 0xc00033c000, 0xc00043c000, 0xc00013c840, 0xc0005ac000, 0x0)</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/metadata/gc.go:94 +0x875</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: github.com/containerd/containerd/metadata.(*DB).getMarked.func1(0xc00043c000, 0x0, 0x0)</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/metadata/db.go:384 +0x16e</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: go.etcd.io/bbolt.(*DB).View(0xc00020e400, 0xc0001d2890, 0x0, 0x0)</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/vendor/go.etcd.io/bbolt/db.go:725 +0x93</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: github.com/containerd/containerd/metadata.(*DB).getMarked(0xc0003170a0, 0x561b6edc88b0, 0xc000040038, 0x203000, 0x203000, 0x0)</span><br><span class=\"line\">Dec 22 18:40:57 localhost systemd[1]: containerd.service: main process exited, code=exited, status=2/INVALIDARGUMENT</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/metadata/db.go:367 +0x7e</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: github.com/containerd/containerd/metadata.(*DB).GarbageCollect(0xc0003170a0, 0x561b6edc88b0, 0xc000040038, 0x0, 0x3, 0x1, 0x2)</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/metadata/db.go:284 +0xa5</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: github.com/containerd/containerd/gc/scheduler.(*gcScheduler).run(0xc000131020, 0x561b6edc88b0, 0xc000040038)</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/gc/scheduler/scheduler.go:310 +0x4bf</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: created by github.com/containerd/containerd/gc/scheduler.init.0.func1</span><br><span class=\"line\">Dec 22 18:40:57 localhost containerd[50977]: /home/runner/work/containerd-nightlies/containerd-nightlies/src/github.com/containerd/containerd/gc/scheduler/scheduler.go:132 +0x445</span><br><span class=\"line\">Dec 22 18:40:57 localhost systemd[1]: Unit containerd.service entered failed state.</span><br><span class=\"line\">Dec 22 18:40:57 localhost systemd[1]: containerd.service failed.</span><br><span class=\"line\">You have mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"确定故障原因\"><a href=\"#确定故障原因\" class=\"headerlink\" title=\"确定故障原因\"></a>确定故障原因</h2><p>上面看到有一个错误，<code>panic: invalid page type: 2: 10</code>应该是由于数据库文件损坏导致的。</p>\n<p>那么可以尝试一下删除数据库文件并且重建后再启动<code>containerd</code>试试。</p>\n<div class=\"custom-quote danger\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M19.76 5.23C15.84 5.23 12 2 12 2C12 2 8.15996 5.23 4.23996 5.23C4.23996 5.23 1.86996 16.99 12 22C22.13 16.99 19.76 5.23 19.76 5.23Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 8V13\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 16H12\"></path>\n</svg>\n</span>\n<p class=\"custom-quote-title\">WARNING</p>\n<p>请注意，删除之前建议先做个备份</p>\n</div>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cp</span> -r /var/lib/containerd /var/lib/containerd.bak</span><br></pre></td></tr></table></figure>\n\n<p>然后直接删除数据库文件：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">rm</span> -rf /var/lib/containerd/*</span><br></pre></td></tr></table></figure>\n\n<p>然后我们重启下<code>containerd</code>服务：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart containerd</span><br></pre></td></tr></table></figure>\n\n<p>重启完成后，再查看一下<code>containerd</code>服务状态：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# systemctl status containerd</span><br><span class=\"line\">● containerd.service - containerd container runtime</span><br><span class=\"line\">   Loaded: loaded (/usr/local/lib/systemd/system/containerd.service; disabled; vendor preset: disabled)</span><br><span class=\"line\">   Active: active (running) since Sun 2024-12-22 18:47:08 CST; 4s ago</span><br><span class=\"line\">     Docs: https://containerd.io</span><br><span class=\"line\">  Process: 54168 ExecStartPre=/sbin/modprobe overlay (code=exited, status=0/SUCCESS)</span><br><span class=\"line\"> Main PID: 54172 (containerd)</span><br><span class=\"line\">    Tasks: 22</span><br><span class=\"line\">   Memory: 25.0M</span><br><span class=\"line\">   CGroup: /system.slice/containerd.service</span><br><span class=\"line\">           └─54172 /usr/local/bin/containerd</span><br><span class=\"line\"></span><br><span class=\"line\">Dec 22 18:47:08 localhost containerd[54172]: <span class=\"keyword\">time</span>=<span class=\"string\">&quot;2024-12-22T18:47:08.314169308+08:00&quot;</span> level=info msg=<span class=\"string\">&quot;loading plugin \\&quot;io.containerd.grpc.v1.....grpc.v1</span></span><br><span class=\"line\"><span class=\"string\">Dec 22 18:47:08 localhost containerd[54172]: time=&quot;</span>2024-12-22T18:47:08.314183237+08:00<span class=\"string\">&quot; level=info msg=&quot;</span>loading plugin \\&quot;io.containerd.grpc.v1.....grpc.v1</span><br><span class=\"line\">Dec 22 18:47:08 localhost containerd[54172]: <span class=\"keyword\">time</span>=<span class=\"string\">&quot;2024-12-22T18:47:08.314197462+08:00&quot;</span> level=info msg=<span class=\"string\">&quot;loading plugin \\&quot;io.containerd.internal...ernal.v1</span></span><br><span class=\"line\"><span class=\"string\">Dec 22 18:47:08 localhost containerd[54172]: time=&quot;</span>2024-12-22T18:47:08.314239313+08:00<span class=\"string\">&quot; level=info msg=&quot;</span>loading plugin \\&quot;io.containerd.grpc.v1.....grpc.v1</span><br><span class=\"line\">Dec 22 18:47:08 localhost containerd[54172]: <span class=\"keyword\">time</span>=<span class=\"string\">&quot;2024-12-22T18:47:08.314260981+08:00&quot;</span> level=info msg=<span class=\"string\">&quot;loading plugin \\&quot;io.containerd.grpc.v1.....grpc.v1</span></span><br><span class=\"line\"><span class=\"string\">Dec 22 18:47:08 localhost containerd[54172]: time=&quot;</span>2024-12-22T18:47:08.314276778+08:00<span class=\"string\">&quot; level=info msg=&quot;</span>loading plugin \\&quot;io.containerd.grpc.v1.....grpc.v1</span><br><span class=\"line\">Dec 22 18:47:08 localhost containerd[54172]: <span class=\"keyword\">time</span>=<span class=\"string\">&quot;2024-12-22T18:47:08.314292198+08:00&quot;</span> level=info msg=<span class=\"string\">&quot;loading plugin \\&quot;io.containerd.grpc.v1.....grpc.v1</span></span><br><span class=\"line\"><span class=\"string\">Dec 22 18:47:08 localhost containerd[54172]: time=&quot;</span>2024-12-22T18:47:08.314520493+08:00<span class=\"string\">&quot; level=info msg=serving... address=/run/containerd/conta...ck.ttrpc</span></span><br><span class=\"line\"><span class=\"string\">Dec 22 18:47:08 localhost containerd[54172]: time=&quot;</span>2024-12-22T18:47:08.314560935+08:00<span class=\"string\">&quot; level=info msg=serving... address=/run/containerd/containerd.sock</span></span><br><span class=\"line\"><span class=\"string\">Dec 22 18:47:08 localhost containerd[54172]: time=&quot;</span>2024-12-22T18:47:08.314621503+08:00<span class=\"string\">&quot; level=info msg=&quot;</span>containerd successfully booted <span class=\"keyword\">in</span> 0.039119s<span class=\"string\">&quot;</span></span><br><span class=\"line\"><span class=\"string\">Hint: Some lines were ellipsized, use -l to show in full.</span></span><br><span class=\"line\"><span class=\"string\">[root@localhost ~]#</span></span><br></pre></td></tr></table></figure>\n\n<p>可以看到<code>containerd</code>服务已经正常启动了。</p>\n<h2 id=\"验证解决方案\"><a href=\"#验证解决方案\" class=\"headerlink\" title=\"验证解决方案\"></a>验证解决方案</h2><p>我们再试试重启容器：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# docker restart -t1 tools-nginx-1</span><br><span class=\"line\">tools-nginx-1</span><br><span class=\"line\">[root@localhost ~]# docker ps -a</span><br><span class=\"line\">CONTAINER ID   IMAGE                    COMMAND                  CREATED          STATUS                                    PORTS     NAMES</span><br><span class=\"line\">0b68949ab785   xxxxxxxxxxxxxx   <span class=\"string\">&quot;tini -- sh -c &#x27;bash…&quot;</span>   11 minutes ago   Up 8 seconds                                        tools-nginx-1</span><br><span class=\"line\">[root@localhost ~]# docker ps -a</span><br></pre></td></tr></table></figure>\n\n<p>可以看到容器已经重启成功，那么至此 <code>containerd</code> 服务异常的问题就解决了，得出结论，数据库文件损坏导致的<code>containerd</code>服务异常，可以尝试删除数据库文件，重建后再启动<code>containerd</code>服务。</p>\n","feature":false,"text":"问题描述在使用 docker 时，发现 docker 守护进程出现连接错误，如下： 123[root@localhost ~]# docker restart ...","permalink":"/post/2025-07-19-02","photos":[],"count_time":{"symbolsCount":"15k","symbolsTime":"13 mins."},"categories":[{"name":"Docker","slug":"Docker","count":1,"path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","slug":"Docker","count":1,"path":"api/tags/Docker.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">问题描述</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%B0%9D%E8%AF%95%E8%A7%A3%E5%86%B3\"><span class=\"toc-text\">尝试解决</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%A1%AE%E5%AE%9A%E6%95%85%E9%9A%9C%E5%8E%9F%E5%9B%A0\"><span class=\"toc-text\">确定故障原因</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%AA%8C%E8%AF%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\"><span class=\"toc-text\">验证解决方案</span></a></li></ol>","author":{"name":"Reverse","slug":"blog-author","avatar":"/images/avatar.jpg","link":"/","description":"每一次的突破，都是自我超越的见证。","socials":{"github":"https://github.com/hyhacct","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"关联数组的声明和使用","uid":"3dc5e75cb441af920dcb5c3ab992895f","slug":"2025-07-19-03","date":"2025-07-19T14:39:17.000Z","updated":"2025-08-16T02:33:51.940Z","comments":true,"path":"api/articles/2025-07-19-03.json","keywords":null,"cover":null,"text":"在 Vue 中12345678const IterateState = (row) => { const state = { 1: \"Success\", 2: ...","permalink":"/post/2025-07-19-03","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"关联数组","slug":"关联数组","count":1,"path":"api/categories/关联数组.json"}],"tags":[{"name":"关联数组 Shell Go Vue.js","slug":"关联数组-Shell-Go-Vue-js","count":1,"path":"api/tags/关联数组-Shell-Go-Vue-js.json"}],"author":{"name":"Reverse","slug":"blog-author","avatar":"/images/avatar.jpg","link":"/","description":"每一次的突破，都是自我超越的见证。","socials":{"github":"https://github.com/hyhacct","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":false},"next_post":{"title":"Categref心跳报错","uid":"4cbb08f3981d46e2c18366238303babb","slug":"2025-07-19-01","date":"2025-07-19T14:28:14.000Z","updated":"2025-08-16T02:33:51.939Z","comments":true,"path":"api/articles/2025-07-19-01.json","keywords":null,"cover":[],"text":"描述之前在工作中碰到的问题，在容器环境中运行夜莺的categref采集器会出现心跳失败的情况，如下： 12345678910111213141516171819...","permalink":"/post/2025-07-19-01","photos":[],"count_time":{"symbolsCount":"3.7k","symbolsTime":"3 mins."},"categories":[{"name":"疑难杂症","slug":"疑难杂症","count":1,"path":"api/categories/疑难杂症.json"}],"tags":[{"name":"Categref 夜莺","slug":"Categref-夜莺","count":1,"path":"api/tags/Categref-夜莺.json"}],"author":{"name":"Reverse","slug":"blog-author","avatar":"/images/avatar.jpg","link":"/","description":"每一次的突破，都是自我超越的见证。","socials":{"github":"https://github.com/hyhacct","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":false}}